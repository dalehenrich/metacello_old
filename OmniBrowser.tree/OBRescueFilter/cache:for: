
!OBRescueFilter methodsFor: 'filtering' stamp: 'lr 11/2/2009 08:07'!
cache: aCollection for: aNode 
	| cached missing inclusionSet |
	cached := cache 
		at: aNode
		ifAbsent: 
			[ ^ self 
				initCache: aCollection
				for: aNode ].
	cache 
		at: aNode
		put: aCollection.
	missing := rescued 
		at: aNode
		ifAbsent: [ Set new ].
	inclusionSet := aCollection asSet.
	missing removeAllSuchThat: [ :ea | inclusionSet includes: ea ].
	cached do: [ :ea | (inclusionSet includes: ea) ifFalse: [ missing add: ea ] ].
	missing isEmpty ifFalse: 
		[ rescued 
			at: aNode
			put: missing ].
	^ missing asArray! !
